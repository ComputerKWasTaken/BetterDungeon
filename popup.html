<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=320">
  <title>BetterDungeon</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <header class="header">
    <div class="logo">
      <img src="icons/icon48.png" alt="" class="logo-icon">
      <span class="logo-text">BetterDungeon</span>
    </div>
    <span class="version">v1.0.0</span>
  </header>

  <nav class="tab-nav">
    <button class="tab-btn active" data-tab="features">Features</button>
    <button class="tab-btn" data-tab="enhancements">Enhancements</button>
  </nav>

  <main class="content">
    <section class="tab-content active" id="tab-features">

      <p class="tab-intro">Configurable additions that add new functionality to your AI Dungeon experience.</p>

      <div class="card-group">
        <header class="card-group-header">
          <h3 class="card-group-title">Story Input Options</h3>
          <p class="card-group-desc">New input modes in the action menu</p>
        </header>

        <article class="card nested" data-feature="command">
          <div class="card-header">
            <div class="card-info">
              <h3 class="card-title">Command Mode</h3>
              <p class="card-desc">Send narrative commands to the AI</p>
            </div>
            <div class="card-actions">
              <button class="chevron-btn" data-expand="command" aria-label="Expand">
                <svg width="10" height="6" viewBox="0 0 10 6"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </button>
              <label class="toggle">
                <input type="checkbox" id="feature-command" checked>
                <span class="toggle-track"></span>
              </label>
            </div>
          </div>
          <div class="card-body" id="expanded-command">
            <p class="card-detail">Adds a <strong>Command</strong> button to the input menu. Text is formatted as <code>## Your Command:</code> for direct AI instructions.</p>
            <p class="card-hint">Great for: Time skips, scene changes, and guiding story direction.</p>
          </div>
        </article>

        <article class="card nested" data-feature="attempt">
          <div class="card-header">
            <div class="card-info">
              <h3 class="card-title">Attempt Mode</h3>
              <p class="card-desc">Dice-roll action outcomes</p>
            </div>
            <div class="card-actions">
              <button class="chevron-btn" data-expand="attempt" aria-label="Expand">
                <svg width="10" height="6" viewBox="0 0 10 6"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </button>
              <label class="toggle">
                <input type="checkbox" id="feature-attempt" checked>
                <span class="toggle-track"></span>
              </label>
            </div>
          </div>
          <div class="card-body" id="expanded-attempt">
            <p class="card-detail">RNG determines if actions succeed or fail. Formats as: <code>You attempt to [action], you [result].</code></p>
            <p class="card-hint">Outcomes: critically fail, fail, succeed, critically succeed. Use arrow keys (‚Üë‚Üì) to adjust odds.</p>
            <div class="card-options">
              <div class="option-row">
                <div class="option-info">
                  <span class="option-label">Critical Chance</span>
                  <span class="option-hint">Chance for critical success/failure (0-20%)</span>
                </div>
                <div class="slider-group">
                  <input type="range" id="critical-chance" min="0" max="20" value="5" class="slider">
                  <span class="slider-value" id="critical-chance-value">5%</span>
                </div>
              </div>
            </div>
          </div>
        </article>
      </div>

      <article class="card" data-feature="markdown">
        <div class="card-header">
          <div class="card-info">
            <h3 class="card-title">Markdown Formatting</h3>
            <p class="card-desc">Rich text in AI responses</p>
          </div>
          <div class="card-actions">
            <button class="chevron-btn" data-expand="markdown" aria-label="Expand">
              <svg width="10" height="6" viewBox="0 0 10 6"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <label class="toggle">
              <input type="checkbox" id="feature-markdown" checked>
              <span class="toggle-track"></span>
            </label>
          </div>
        </div>
        <div class="card-body" id="expanded-markdown">
          <p class="card-detail">Renders <strong>bold</strong>, <em>italic</em>, <u>underline</u>, and more using a custom asterisk-free markdown syntax.</p>
          <div class="syntax-reference">
            <h4 class="syntax-title">Syntax Reference</h4>
            <div class="syntax-grid">
              <code>__text__</code><span><strong>bold</strong></span>
              <code>_text_</code><span><em>italic</em></span>
              <code>==text==</code><span><u>underline</u></span>
              <code>^text^</code><span><sup>whisper</sup></span>
              <code>~text~</code><span><sub>muffled</sub></span>
              <code>---</code><span>scene break</span>
              <code>- item</code><span>‚Ä¢ list item</span>
            </div>
          </div>
          <div class="card-options">
            <div class="option-row">
              <div class="option-info">
                <span class="option-label">Auto-apply on adventure</span>
                <span class="option-hint">Inject formatting instructions when entering an adventure</span>
              </div>
              <label class="toggle sm">
                <input type="checkbox" id="auto-apply-instructions">
                <span class="toggle-track"></span>
              </label>
            </div>
            <div class="option-row">
              <div class="option-info">
                <span class="option-label">Apply Instructions</span>
                <span class="option-hint">Manually inject formatting guidelines into current adventure</span>
              </div>
              <button class="btn-sm" id="apply-instructions-btn">Apply</button>
            </div>
          </div>
          <p class="card-note">The AI may not always output Markdown formatting in its responses, and you may need to nudge it. <strong>Big thanks to <a href="https://play.aidungeon.com/profile/OffMetaGamer">OffMetaGamer</a> and <a href="https://play.aidungeon.com/profile/effortlyss">Shiny</a> for their help with this feature!</strong></p>
        </div>
      </article>

      <article class="card" data-feature="triggerHighlight">
        <div class="card-header">
          <div class="card-info">
            <h3 class="card-title">Trigger Highlighting</h3>
            <p class="card-desc">Visualize story card triggers</p>
          </div>
          <div class="card-actions">
            <button class="chevron-btn" data-expand="triggerHighlight" aria-label="Expand">
              <svg width="10" height="6" viewBox="0 0 10 6"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <label class="toggle">
              <input type="checkbox" id="feature-triggerHighlight" checked>
              <span class="toggle-track"></span>
            </label>
          </div>
        </div>
        <div class="card-body" id="expanded-triggerHighlight">
          <p class="card-detail">Highlights story card triggers in the context viewer. Hover for card name tooltips.</p>
          <p class="card-hint"><strong>Suggested Triggers:</strong> Frequently mentioned names/places without story cards appear in cyan with dashed underlines.</p>
          <div class="card-options">
            <div class="option-row">
              <div class="option-info">
                <span class="option-label">Auto-scan on adventure</span>
                <span class="option-hint">Scan story cards when entering an adventure</span>
              </div>
              <label class="toggle sm">
                <input type="checkbox" id="auto-scan-triggers">
                <span class="toggle-track"></span>
              </label>
            </div>
            <p class="option-warning">‚ö†Ô∏è Auto-scan will increase load times on adventures with many story cards.</p>
            <div class="option-row">
              <div class="option-info">
                <span class="option-label">Scan Story Cards</span>
                <span class="option-hint">Manually scan triggers for current adventure</span>
              </div>
              <button class="btn-sm" id="scan-triggers-btn">Scan</button>
            </div>
          </div>
        </div>
      </article>

    </section>

    <section class="tab-content" id="tab-enhancements">
      <p class="tab-intro">Automatic improvements that are always active, no configuration needed.</p>
      <div class="enhancement-list">
        <article class="enhancement-card" data-feature="hotkey">
          <span class="enhancement-icon">‚å®Ô∏è</span>
          <div class="enhancement-info">
            <h3 class="enhancement-title">Hotkeys</h3>
            <p class="enhancement-desc">Keyboard shortcuts for quick actions.</p>
          </div>
          <div class="enhancement-actions">
            <button class="chevron-btn" data-expand="hotkey-details" aria-label="Expand">
              <svg width="10" height="6" viewBox="0 0 10 6"><path d="M1 1l4 4 4-4" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <label class="toggle">
              <input type="checkbox" id="feature-hotkey" checked>
              <span class="toggle-track"></span>
            </label>
          </div>
        </article>
        <div class="enhancement-details" id="hotkey-details">
          <div class="hotkey-list">
            <div class="hotkey-group">
              <h4 class="hotkey-group-title">Actions</h4>
              <div class="hotkey-item"><kbd>T</kbd> Take a Turn</div>
              <div class="hotkey-item"><kbd>C</kbd> Continue</div>
              <div class="hotkey-item"><kbd>R</kbd> Retry</div>
              <div class="hotkey-item"><kbd>E</kbd> Erase</div>
            </div>
            <div class="hotkey-group">
              <h4 class="hotkey-group-title">History</h4>
              <div class="hotkey-item"><kbd>Z</kbd> Undo</div>
              <div class="hotkey-item"><kbd>Y</kbd> Redo</div>
            </div>
            <div class="hotkey-group">
              <h4 class="hotkey-group-title">Input Modes</h4>
              <div class="hotkey-item"><kbd>1</kbd> Do</div>
              <div class="hotkey-item"><kbd>2</kbd> Attempt*</div>
              <div class="hotkey-item"><kbd>3</kbd> Say</div>
              <div class="hotkey-item"><kbd>4</kbd> Story</div>
              <div class="hotkey-item"><kbd>5</kbd> See</div>
              <div class="hotkey-item"><kbd>6</kbd> Command*</div>
            </div>
            <p class="hotkey-note">*Requires feature to be enabled</p>
          </div>
        </div>
        <article class="enhancement-card">
          <span class="enhancement-icon">üìñ</span>
          <div class="enhancement-info">
            <h3 class="enhancement-title">Readable Tab Fix</h3>
            <p class="enhancement-desc">Moves "Readable" tab back to its rightful place after "All" in Section Tabs.</p>
          </div>
        </article>
      </div>
    </section>
  </main>

  <script src="popup.js"></script>
</body>
</html>
